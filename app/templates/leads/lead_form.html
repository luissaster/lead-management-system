{% extends 'base.html' %}
{% load static %}

{% block title %}Cadastrar Novo Lead{% endblock %}

{% block content %}
    <h2>Cadastrar Novo Lead</h2>
    <img src="{% static 'images/img.jpg' %}" alt="Gatinho de óculos escuro (Apenas para cumprir o requisito de servir uma imagem)" class="img"/>
    {% if messages %}
      <ul class="messages">
        {% for message in messages %}
          <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
        {% endfor %}
      </ul>
    {% endif %}

    <form method="post">
        {% csrf_token %}
        {% for field in form %}
          <div class="form-group">
            <label for="{{ field.id_for_label }}">
              {{ field.label }}
              {% if field.field.required %}<span style="color: red;">*</span>{% endif %}
            </label>
            {{ field }}
            {% if field.help_text %}<small>{{ field.help_text }}</small>{% endif %}
            {% for error in field.errors %}
              <div style="color: red; font-size: 0.9em;">{{ error }}</div>
            {% endfor %}
          </div>
        {% endfor %}
        <button type="submit">Salvar</button>
    </form>

    <script>
    // Máscara de telefone
    document.addEventListener('DOMContentLoaded', function() {
      var telInput = document.getElementById('id_telefone');
      if (telInput) {
        telInput.addEventListener('input', function(e) {
          let x = e.target.value.replace(/\D/g, '').slice(0, 11);
          let formatted = '';
          if (x.length > 0) formatted += '(' + x.substring(0, 2);
          if (x.length >= 3) formatted += ') ' + x.substring(2, 7);
          if (x.length >= 7) formatted += '-' + x.substring(7, 11);
          e.target.value = formatted;
        });
      }
    });
    </script>
{% endblock %}